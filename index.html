<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Invoice Generator</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-6 text-sm">
  <div class="max-w-4xl mx-auto bg-white p-8 rounded shadow space-y-6">
    <h1 class="text-2xl font-bold mb-4">Invoice Generator</h1>

    <!-- Logo Upload -->
    <div class="mb-4">
      <label class="block font-semibold mb-1">Upload Your Logo</label>
      <input type="file" accept="image/*" id="logoInput" class="mb-2">
      <img id="logoPreview" src="" alt="Logo Preview" class="max-h-20">
    </div>

    <!-- From & To -->
    <div class="grid md:grid-cols-2 gap-6">
      <div>
        <label class="font-semibold">Billing From</label>
        <textarea id="from" rows="5" class="w-full border p-3 rounded resize-y" placeholder="Your company name, address, VAT number..."></textarea>
      </div>
      <div>
        <label class="font-semibold">Billing To</label>
        <textarea id="to" rows="5" class="w-full border p-3 rounded resize-y" placeholder="Client name, address, VAT number..."></textarea>
      </div>
    </div>

    <!-- Invoice Dates -->
    <div class="grid md:grid-cols-3 gap-6">
      <div>
        <label class="font-semibold">Invoice Date</label>
        <input type="date" id="invoiceDate" class="w-full border p-3 rounded">
      </div>
      <div>
        <label class="font-semibold">Payment Terms</label>
        <select id="paymentTerms" class="w-full border p-3 rounded">
          <option value="7">7 days</option>
          <option value="14">14 days</option>
          <option value="30" selected>30 days</option>
          <option value="60">60 days</option>
        </select>
      </div>
      <div>
        <label class="font-semibold">Due Date</label>
        <input type="date" id="dueDate" class="w-full border p-3 rounded" readonly>
      </div>
    </div>

    <!-- Invoice Table -->
    <div class="overflow-x-auto">
      <table class="w-full border mt-6">
        <thead class="bg-gray-200">
          <tr>
            <th class="p-2 border">Description</th>
            <th class="p-2 border">Qty</th>
            <th class="p-2 border">Unit Price</th>
            <th class="p-2 border">VAT %</th>
            <th class="p-2 border">Net</th>
            <th class="p-2 border">VAT</th>
            <th class="p-2 border">Gross</th>
          </tr>
        </thead>
        <tbody id="items">
          <tr>
            <td class="border p-2"><textarea class="w-full border p-2 rounded resize-y" rows="2" placeholder="Item description"></textarea></td>
            <td class="border p-2"><input type="number" class="w-full border p-2 rounded qty" value="1"></td>
            <td class="border p-2"><input type="number" class="w-full border p-2 rounded price" value="0"></td>
            <td class="border p-2"><input type="number" class="w-full border p-2 rounded vatRate" value="20"></td>
            <td class="border p-2 net">0.00</td>
            <td class="border p-2 vat">0.00</td>
            <td class="border p-2 gross">0.00</td>
          </tr>
        </tbody>
      </table>
    </div>

    <button onclick="addItem()" class="mt-2 px-4 py-2 bg-blue-600 text-white rounded">+ Add Item</button>

    <!-- Totals -->
    <div class="text-right mt-4 space-y-1">
      <div><strong>Total Net:</strong> £<span id="totalNet">0.00</span></div>
      <div><strong>Total VAT:</strong> £<span id="totalVAT">0.00</span></div>
      <div><strong>Total Gross:</strong> £<span id="totalGross">0.00</span></div>
    </div>
  </div>

  <script>
    function calculate() {
      let totalNet = 0, totalVAT = 0, totalGross = 0;
      document.querySelectorAll('#items tr').forEach(row => {
        const qty = parseFloat(row.querySelector('.qty')?.value) || 0;
        const price = parseFloat(row.querySelector('.price')?.value) || 0;
        const vatRate = parseFloat(row.querySelector('.vatRate')?.value) || 0;

        const net = qty * price;
        const vat = net * (vatRate / 100);
        const gross = net + vat;

        row.querySelector('.net').textContent = net.toFixed(2);
        row.querySelector('.vat').textContent = vat.toFixed(2);
        row.querySelector('.gross').textContent = gross.toFixed(2);

        totalNet += net;
        totalVAT += vat;
        totalGross += gross;
      });

      document.getElementById('totalNet').textContent = totalNet.toFixed(2);
      document.getElementById('totalVAT').textContent = totalVAT.toFixed(2);
      document.getElementById('totalGross').textContent = totalGross.toFixed(2);
    }

    function addItem() {
      const row = document.createElement('tr');
      row.innerHTML = `
        <td class="border p-2"><textarea class="w-full border p-2 rounded resize-y" rows="2" placeholder="Item description"></textarea></td>
        <td class="border p-2"><input type="number" class="w-full border p-2 rounded qty" value="1"></td>
        <td class="border p-2"><input type="number" class="w-full border p-2 rounded price" value="0"></td>
        <td class="border p-2"><input type="number" class="w-full border p-2 rounded vatRate" value="20"></td>
        <td class="border p-2 net">0.00</td>
        <td class="border p-2 vat">0.00</td>
        <td class="border p-2 gross">0.00</td>
      `;
      document.getElementById('items').appendChild(row);
      bindInputs();
    }

    function bindInputs() {
      document.querySelectorAll('.qty, .price, .vatRate').forEach(input => {
        input.addEventListener('input', calculate);
      });
    }

    // Invoice date and due date logic
    document.getElementById('invoiceDate').addEventListener('change', updateDueDate);
    document.getElementById('paymentTerms').addEventListener('change', updateDueDate);

    function updateDueDate() {
      const invoiceDate = new Date(document.getElementById('invoiceDate').value);
      const terms = parseInt(document.getElementById('paymentTerms').value);
      if (!isNaN(invoiceDate) && terms) {
        invoiceDate.setDate(invoiceDate.getDate() + terms);
        document.getElementById('dueDate').value = invoiceDate.toISOString().split('T')[0];
      }
    }

    // Logo upload
    document.getElementById('logoInput').addEventListener('change', e => {
      const file = e.target.files[0];
      const reader = new FileReader();
      reader.onload = function (event) {
        document.getElementById('logoPreview').src = event.target.result;
      };
      if (file) reader.readAsDataURL(file);
    });

    // Prefill today's date
    window.addEventListener('DOMContentLoaded', () => {
      const today = new Date().toISOString().split('T')[0];
      document.getElementById('invoiceDate').value = today;
      updateDueDate();
      bindInputs();
      calculate();
    });
  </script>
</body>
</html>
